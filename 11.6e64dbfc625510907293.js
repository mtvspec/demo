(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{xQww:function(t,n,o){"use strict";o.r(n),o.d(n,"FeedModule",function(){return K});var e=o("ofXK"),i=o("tyNb"),c=o("wd/R"),a=o.n(c),s=o("vkgz"),r=o("lJxs"),p=o("fXoL"),m=o("GzcL"),l=o("/IUn");let d=(()=>{class t{constructor(t){this.apollo=t}fetchPostList(t){return this.apollo.watchQuery({query:m.E,fetchPolicy:"no-cache",variables:t})}fetchPost(t,n){return this.apollo.query({query:m.D,fetchPolicy:"no-cache",variables:{id:t,filter:n}})}publish(t){return this.apollo.mutate({mutation:m.G,fetchPolicy:"no-cache",variables:{data:t}})}addCommentOnPost(t){return this.apollo.mutate({mutation:m.d,fetchPolicy:"no-cache",variables:{data:t}})}}return t.\u0275fac=function(n){return new(n||t)(p.Tb(l.c))},t.\u0275prov=p.Fb({token:t,factory:t.\u0275fac,providedIn:"root"}),t})();var b=o("3Pt+"),g=o("2YBG");function f(t,n){if(1&t){const t=p.Qb();p.Pb(0,"form",1),p.Wb("ngSubmit",function(){return p.kc(t),p.Yb().publish()}),p.Pb(1,"button",2),p.qc(2),p.Ob(),p.Pb(3,"div",3),p.Pb(4,"div",4),p.Kb(5,"img",5),p.Ob(),p.Kb(6,"textarea",6),p.Ob(),p.Pb(7,"button"),p.Pb(8,"lib-file",7),p.Wb("newFile",function(n){return p.kc(t),p.Yb().onImageUpload(n)}),p.Ob(),p.Ob(),p.Ob()}if(2&t){const t=p.Yb();p.ec("formGroup",t.form),p.zb(1),p.ec("disabled",t.form.invalid),p.zb(1),p.rc(t.operationInFly?"\u041f\u043e\u0434\u043e\u0436\u0434\u0438\u0442\u0435":"\u041e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u0442\u044c"),p.zb(4),p.ec("formControl",t.form.controls.text),p.zb(2),p.ec("label","\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c \u0444\u043e\u0442\u043e")}}let u=(()=>{class t{constructor(t,n){this.fb=t,this.postService=n,this.operationInFly=!1,this.newPost=new p.n,this.form=this.fb.group({text:new b.c(null,[b.q.required]),image:new b.c(null)})}ngOnInit(){}publish(){var t;(null===(t=this.form)||void 0===t?void 0:t.valid)&&(this.operationInFly=!0,this.postService.publish(this.form.value).subscribe(t=>{var n,o,e;this.operationInFly=!1,(null===(n=t.data)||void 0===n?void 0:n.payload.id)&&(null===(e=null===(o=this.form)||void 0===o?void 0:o.get("text"))||void 0===e||e.setValue(null),this.newPost.emit())}))}onImageUpload(t){var n,o;null===(o=null===(n=this.form)||void 0===n?void 0:n.get("image"))||void 0===o||o.setValue(t.id)}}return t.\u0275fac=function(n){return new(n||t)(p.Jb(b.b),p.Jb(d))},t.\u0275cmp=p.Db({type:t,selectors:[["app-new-post"]],outputs:{newPost:"newPost"},decls:1,vars:1,consts:[["class","new-post",3,"formGroup","ngSubmit",4,"ngIf"],[1,"new-post",3,"formGroup","ngSubmit"],[3,"disabled"],[1,"row"],[1,"avatar"],["src","../../assets/girl.png"],["name","text","id","text","rows","1","required","","placeholder","\u0427\u0442\u043e \u0443 \u0432\u0430\u0441 \u043d\u043e\u0432\u043e\u0433\u043e?",3,"formControl"],["color","white",3,"label","newFile"]],template:function(t,n){1&t&&p.pc(0,f,9,5,"form",0),2&t&&p.ec("ngIf",n.form)},directives:[e.l,b.r,b.j,b.g,b.a,b.o,b.i,b.d,g.a],styles:[".new-post[_ngcontent-%COMP%]{background-color:var(--primary-bg);box-shadow:0 0 1px 0 #00000080}.new-post[_ngcontent-%COMP%], .new-post[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{display:flex;flex-direction:column}.new-post[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{align-items:center;justify-content:center;width:48px;height:48px}.new-post[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:50%;box-shadow:0 0 1px 0 #00000080}.new-post[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;border:none;resize:none;font-size:16px;font-family:var(--primary-font-family);padding:15px}.new-post[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none}"]}),t})();var P=o("jrmO"),O=o("4kJo"),h=o("tdo0");function v(t,n){if(1&t){const t=p.Qb();p.Pb(0,"form",2),p.Wb("ngSubmit",function(){return p.kc(t),p.Yb().send()}),p.Pb(1,"div",3),p.Kb(2,"app-user-avatar",4),p.Kb(3,"div",5),p.Ob(),p.Pb(4,"div",6),p.Kb(5,"textarea",7),p.Ob(),p.Pb(6,"div",8),p.Pb(7,"button",9),p.qc(8,">"),p.Ob(),p.Ob(),p.Ob()}if(2&t){const t=p.Yb();p.ec("formGroup",t.form),p.zb(2),p.ec("avatar",t.post.author.avatar),p.zb(3),p.ec("formControl",t.form.controls.comment),p.zb(2),p.ec("disabled",t.form.invalid)}}let C=(()=>{class t{constructor(t,n){this.fb=t,this.postService=n,this.updatedPost=new p.n}ngOnInit(){this.form=this.fb.group({comment:new b.c(null,[b.q.required])})}send(){var t;(null===(t=this.form)||void 0===t?void 0:t.valid)&&this.post.id&&this.postService.addCommentOnPost({post:this.post.id,comment:this.form.value.comment}).subscribe(t=>{var n,o,e,i;(null===(o=null===(n=t.data)||void 0===n?void 0:n.payload)||void 0===o?void 0:o.id)&&this.post.id&&(null===(i=null===(e=this.form)||void 0===e?void 0:e.get("comment"))||void 0===i||i.setValue(null),this.postService.fetchPost(this.post.id,{last:3}).subscribe(t=>{console.log("Post",t.data.post),t.data.post&&this.updatedPost.emit(t.data.post)}))})}}return t.\u0275fac=function(n){return new(n||t)(p.Jb(b.b),p.Jb(d))},t.\u0275cmp=p.Db({type:t,selectors:[["app-new-post-comment"]],inputs:{post:"post"},outputs:{updatedPost:"updatedPost"},decls:2,vars:1,consts:[[1,"new-comment"],["class","row",3,"formGroup","ngSubmit",4,"ngIf"],[1,"row",3,"formGroup","ngSubmit"],[1,"controls"],[3,"avatar"],[1,"empty-space"],[1,"text"],["name","comment","id","comment","rows","1","placeholder","\u041e\u0441\u0442\u0430\u0432\u0438\u0442\u044c \u043a\u043e\u043c\u043c\u0435\u043d\u0442\u0430\u0440\u0438\u0439","required","",3,"formControl"],[1,"actions"],["type","submit",1,"send",3,"disabled"]],template:function(t,n){1&t&&(p.Pb(0,"div",0),p.pc(1,v,9,4,"form",1),p.Ob()),2&t&&(p.zb(1),p.ec("ngIf",n.form))},directives:[e.l,b.r,b.j,b.g,O.a,b.a,b.o,b.i,b.d],styles:[".new-comment[_ngcontent-%COMP%]{flex-direction:row;background-color:var(--primary-bg)}.new-comment[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:row;width:100%}.new-comment[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div.actions[_ngcontent-%COMP%]{margin-right:8px;display:flex;flex-direction:row;align-items:center}.new-comment[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]   div.actions[_ngcontent-%COMP%]   button.send[_ngcontent-%COMP%]{padding:8px 12px;margin:0;font-size:14px;font-family:var(--primary-font-family)}.new-comment[_ngcontent-%COMP%]   .controls[_ngcontent-%COMP%]{padding:8px;display:flex;align-items:center;z-index:1}.new-comment[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{width:100%;display:flex;align-items:center;margin:10px 8px 10px 0;padding:7px 12px;border-radius:12px;background-color:#f9f9f9f0;box-shadow:0 0 1px 0 #00000080}.new-comment[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;margin:0;padding:0;font-size:16px;font-family:var(--primary-font-family);border:none;background-color:initial;height:auto;resize:none}.new-comment[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]::-webkit-input-placeholder{font-size:14px}.new-comment[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus, .new-comment[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus-within{outline:none}"]}),t})();function M(t,n){if(1&t&&(p.Pb(0,"div",17),p.Pb(1,"div",18),p.Kb(2,"app-user-avatar",19),p.Pb(3,"span",20),p.qc(4),p.Ob(),p.Kb(5,"div",5),p.Pb(6,"div",6),p.Pb(7,"span",6),p.qc(8),p.Ob(),p.Ob(),p.Ob(),p.Pb(9,"div",16),p.qc(10),p.Ob(),p.Pb(11,"div",21),p.Pb(12,"span"),p.qc(13," \u041d\u0440\u0430\u0432\u0438\u0442\u0441\u044f "),p.Ob(),p.Pb(14,"span"),p.qc(15," \u041e\u0442\u0432\u0435\u0442\u0438\u0442\u044c "),p.Ob(),p.Ob(),p.Ob()),2&t){const t=n.$implicit,o=p.Yb(2);p.zb(2),p.ec("avatar",t.node.avatar),p.zb(2),p.sc(" ",t.node.createdBy.name," "),p.zb(4),p.rc(o.moment(t.node.createdAt).locale("ru").fromNow()),p.zb(2),p.sc(" ",t.node.comment," ")}}function _(t,n){if(1&t){const t=p.Qb();p.Pb(0,"div",1),p.Pb(1,"div",2),p.Kb(2,"app-user-avatar"),p.Pb(3,"div",3),p.Pb(4,"span",4),p.qc(5),p.Ob(),p.Kb(6,"div",5),p.Pb(7,"span",6),p.qc(8),p.Ob(),p.Ob(),p.Ob(),p.Pb(9,"div",7),p.Kb(10,"lib-photo-viewer",8),p.Ob(),p.Kb(11,"div",9),p.Pb(12,"div",10),p.Pb(13,"button",11),p.qc(14,"\u041d\u0440\u0430\u0432\u0438\u0442\u0441\u044f"),p.Ob(),p.Kb(15,"div",5),p.Pb(16,"button",11),p.qc(17,"\u041f\u043e\u0434\u0435\u043b\u0438\u0442\u044c\u0441\u044f"),p.Ob(),p.Ob(),p.Pb(18,"div",12),p.Pb(19,"app-new-post-comment",13),p.Wb("updatedPost",function(n){return p.kc(t),p.Yb().onPostUpdate(n)}),p.Ob(),p.pc(20,M,16,4,"div",14),p.Ob(),p.Pb(21,"div",15),p.Pb(22,"span",16),p.qc(23),p.Ob(),p.Ob(),p.Ob()}if(2&t){const t=p.Yb();p.zb(5),p.rc(t.post.author.name),p.zb(3),p.rc(t.moment(t.post.createdAt).locale("ru").fromNow()),p.zb(2),p.ec("file",t.post.image),p.zb(9),p.ec("post",t.post),p.zb(1),p.ec("ngForOf",t.post.comments.edges),p.zb(3),p.rc(t.post.text)}}let w=(()=>{class t{constructor(){this.moment=a.a,this.moment.locale("ru",{relativeTime:{future:"in %s",past:"%s ago",s:"seconds",ss:"%ss",m:"a minute",mm:"%dm",h:"an hour",hh:"%dh",d:"a day",dd:"%dd",M:"a month",MM:"%dM",y:"a year",yy:"%dY"}})}ngOnInit(){}onPostUpdate(t){this.post=t}fromNow(){}}return t.\u0275fac=function(n){return new(n||t)},t.\u0275cmp=p.Db({type:t,selectors:[["app-post-item"]],inputs:{post:"post"},decls:1,vars:1,consts:[["class","post",4,"ngIf"],[1,"post"],[1,"row","metadata"],[1,"row","info"],[1,"author-name"],[1,"empty-space"],[1,"time"],[1,"image"],[3,"file"],[1,"likes"],[1,"panel","post-actions","row"],[1,"flat"],[1,"comment-list"],[3,"post","updatedPost"],["class","column comment",4,"ngFor","ngForOf"],[1,"panel"],[1,"text"],[1,"column","comment"],[1,"row","comment-author"],[3,"avatar"],[1,"name"],[1,"comment-actions"]],template:function(t,n){1&t&&p.pc(0,_,24,6,"div",0),2&t&&p.ec("ngIf",n.post)},directives:[e.l,O.a,h.a,C,e.k],styles:[".post[_ngcontent-%COMP%]{margin:6px 0;display:flex;flex-direction:column}.post[_ngcontent-%COMP%]   .metadata[_ngcontent-%COMP%]{padding:0 8px;align-items:center;height:60px;background-color:var(--primary-bg);box-shadow:0 0 1px 0 #00000080}.post[_ngcontent-%COMP%]   .metadata[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;width:48px;height:48px}.post[_ngcontent-%COMP%]   .metadata[_ngcontent-%COMP%]   .avatar[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{border:none;width:32px;height:32px;border-radius:50%;box-shadow:0 0 1px 0 #00000080}.post[_ngcontent-%COMP%]   .metadata[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]{align-items:center;padding:15px;width:100%;display:flex;flex-direction:row}.post[_ngcontent-%COMP%]   .metadata[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .author-name[_ngcontent-%COMP%]{font-size:14px;font-weight:500;font-family:var(--primary-font-family)}.post[_ngcontent-%COMP%]   .metadata[_ngcontent-%COMP%]   .info[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{font-size:12px;font-family:var(--primary-font-family);color:#888}.post[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]{display:flex;flex-direction:column;border:none;box-shadow:none;margin:0;padding:0;width:-moz-fit-content;width:fit-content;min-height:100px;height:auto;background-color:#f0f8ff}.post[_ngcontent-%COMP%]   .image[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:100%;height:auto;object-fit:fill}.post[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{font-size:14px;font-family:var(--primary-font-family);color:#555}.post[_ngcontent-%COMP%]   .comment-list[_ngcontent-%COMP%]{background-color:var(--primary-bg)}.post[_ngcontent-%COMP%]   .comment-list[_ngcontent-%COMP%]   .comment[_ngcontent-%COMP%]{background-color:var(--secondary-bg);border-radius:12px;margin:24px}.post[_ngcontent-%COMP%]   .comment-list[_ngcontent-%COMP%]   .comment[_ngcontent-%COMP%]   .comment-author[_ngcontent-%COMP%]{padding:8px;display:flex;flex-direction:row;align-items:center}.post[_ngcontent-%COMP%]   .comment-list[_ngcontent-%COMP%]   .comment[_ngcontent-%COMP%]   .comment-author[_ngcontent-%COMP%]   .name[_ngcontent-%COMP%]{padding-left:12px;font-size:14px;font-family:var(--primary-font-family);font-weight:500}.post[_ngcontent-%COMP%]   .comment-list[_ngcontent-%COMP%]   .comment[_ngcontent-%COMP%]   .comment-author[_ngcontent-%COMP%]   .time[_ngcontent-%COMP%]{font-size:12px;font-family:var(--primary-font-family);font-weight:400;color:#888}.post[_ngcontent-%COMP%]   .comment-list[_ngcontent-%COMP%]   .comment[_ngcontent-%COMP%]   .comment-actions[_ngcontent-%COMP%], .post[_ngcontent-%COMP%]   .comment-list[_ngcontent-%COMP%]   .comment[_ngcontent-%COMP%]   .text[_ngcontent-%COMP%]{padding:8px 12px}.post[_ngcontent-%COMP%]   .comment-list[_ngcontent-%COMP%]   .comment[_ngcontent-%COMP%]   .comment-actions[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{margin-right:8px;font-size:13px;font-family:var(--primary-font-family);font-weight:400;color:#0f448a}.post[_ngcontent-%COMP%]   .post-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin:0}"]}),t})();function x(t,n){1&t&&(p.Pb(0,"div",4),p.qc(1," Loading...\n"),p.Ob())}function y(t,n){1&t&&p.Kb(0,"app-post-item",7),2&t&&p.ec("post",n.$implicit)}function z(t,n){if(1&t&&(p.Pb(0,"div",5),p.pc(1,y,1,1,"app-post-item",6),p.Ob()),2&t){const t=n.ngIf;p.zb(1),p.ec("ngForOf",t.nodes)}}const I=[{path:"",component:(()=>{class t{constructor(t){this.postService=t,this.loading=!0,this.moment=a.a}ngOnInit(){this.fetchPostList()}onNewPost(){this.fetchPostList()}fetchPostList(){this.$postList=this.postService.fetchPostList({filter:{last:3}}).valueChanges.pipe(Object(s.a)(t=>this.loading=t.loading),Object(r.a)(t=>t.data.postList))}}return t.\u0275fac=function(n){return new(n||t)(p.Jb(d))},t.\u0275cmp=p.Db({type:t,selectors:[["app-feed"]],decls:6,vars:4,consts:[[3,"newPost"],["class","loading",4,"ngIf"],["class","post-list",4,"ngIf"],[1,"space"],[1,"loading"],[1,"post-list"],[3,"post",4,"ngFor","ngForOf"],[3,"post"]],template:function(t,n){1&t&&(p.Pb(0,"app-new-post",0),p.Wb("newPost",function(){return n.onNewPost()}),p.Ob(),p.pc(1,x,2,0,"div",1),p.pc(2,z,2,1,"div",2),p.Zb(3,"async"),p.Kb(4,"div",3),p.Kb(5,"app-main-toolbar")),2&t&&(p.zb(1),p.ec("ngIf",n.loading),p.zb(1),p.ec("ngIf",p.ac(3,2,n.$postList)))},directives:[u,e.l,P.a,e.k,w],pipes:[e.b],styles:[""]}),t})()}];let q=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=p.Hb({type:t}),t.\u0275inj=p.Gb({imports:[[i.f.forChild(I)],i.f]}),t})();var k=o("PCNd");let K=(()=>{class t{}return t.\u0275fac=function(n){return new(n||t)},t.\u0275mod=p.Hb({type:t}),t.\u0275inj=p.Gb({imports:[[e.c,k.a,q]]}),t})()}}]);